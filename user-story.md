# User story

> ## Application name

`home-expenses`

---

> ## Description

Приложение предназначено для ведения учета и контроля персональных расходов.
С помощью приложения пользователи могут создавать список категорий расходов, задавать подкатегории расходов из состава ранее созданных категорий расходов, вводить значения расходных статей с указанием категорий и подкатегорий расходов, получать отчеты о тратах с разбивкой по категориям и подкатегориям. Отчеты представляются в виде таблиц и столбцовых диаграмм за предустановленные периоды времени (день, неделя, месяц) или за выбираемый пользователем произвольный период с разбивкой по категориям и подкатегориям.

---

> ## Pages

При открытии сайта проверяется, вошел пользователь в систему или нет. Если пользователь вошел, то идет перенаправление на `Dashboard page`. Если пользователь не вошел, то идет перенаправление на `Signin page`.

1.  ### `Signin page` - страница входа в приложение.

    На этой странице отображаются поля ввода `Email`, `Password` и кнопка `Sign in`.
    Ниже кнопки `Sign in` находится ссылка перехода на страницу регистрации `Signup page`.
    По нажатию на кнопку `Sign in` отправляется запрос на backend. Если `email` и `password` правильно введены, то backend возвращает `JWT`, который в дальнейшем используется для запросов к backend. Если `email` и `password` не правильно введены, то backend возвращает ответ с указанием на ошибку и на странице `Signin page` показвается сообщение об ошибочном вводе. После получения `JWT`, он сохраняется в local storage, а затем идет перенаправление на страницу `Dashboard page`.

2.  ### `Signup page` - страница регистрации в приложении.

    На этой странице отображаются поля ввода `Email`, `Password`, `Repeat Password` и кнопка `Sign up`.
    Ниже кнопки `Sign up` находится ссылка перехода на страницу входа в приложение `Signin page`.
    По нажатию на кнопку `Sign up` отправляется запрос на backend. Backend формирует письмо, с однократным кодом регистрации и отправляет его на указанный email (в учебном варианте ссылка выводится в консоли работающего backend'а). Пользователь открывает в почтовом клиенте письмо и нажимает на ссылку в письме с кодом регистрации (в учебном варианте пользователь открываетс ссылку в консоли работающего backend'а). Ссылка ведет на frontend на страницу `Email verification page`.

3.  ### `Email verification page` - страница проверки email при регистрации в приложении.

    На этой странице отображаются поля ввода `Email` без возможности редактирования, скрытое поле с кодом регистрации и кнопка `Verify email`.
    Ниже кнопки `Verify email` находится ссылка перехода на страницу входа в приложение `Signin page`.
    По нажатию на кнопку `Verify email` отправляется запрос на backend с email и кодом регистрации. Backend проверяет email и код регистрации, и в случае успеха возвращает JWT. Далее действия производятся аналогично `Signin page`. Если ответ от backend отрицательный, то выдается сообщению пользователю об ощибке проверки email.

4.  ### `Dashboard page` - основная страница приложения.

    На основной странице отображается форма ввода расходов и списох последних 20 введенных ранее расходов отсортированных в обратном хронологическом порядке. Для пользователя доступны следующие поля ввода:

    - выпадающий список категорий (данные для списка получаются от backend'а);
    - текстовое поле наименование расхода (может оставаться пустым, при вводе предлагается автодополнение из списка ранее введенных наименования расхода, список автодополнения получается от backend'а);
    - числовое поле ввода величины расхода (в денежных единицах);
    - кнопка, подтверждающая ввод данных о расходе из формы в приложение.

    В верхней части `Dashboard page` отображается иконка с изображением фотографии пользователя или placeholder-картинка, если пользователем не задана фотография. По нажатию на эту иконку появляется dropdown-меню с пунктом `Sign out`. Нажатие на пункт меню `Sign out` осуществляет сброс состояния текущего пользователя и JWT, и идет перенаправление на страницу `Sign in page`. Слева от иконки располагается надпись, отображающая email зарегистрированного в приложении пользователя.

    В левой части `Dashboard page` отображается sidebar с перечнем страниц. Нажатие на название страницы приводит к переключению текущей отображаемой страницы.

    Перечень страниц в меню:

    - `Dashboard`;
    - `Reports`;
    - `Config`.

5.  ### `Reports page` - страница отчетов о расходах.

    На странице в верхней части располагается надпись, отображающая выбранный период для отчета о расходах (дата начала и дата окончания периода). Далее, справа от надписи располагаются две кнопки с изображением стрелок. Нажатие на эти кнопки осуществляет изменение даты начала и даты окончания, путем одновременного уменьшения обеих этих дат на величину, выраженную в днях и равную разнице даты окончания и даты начала периода отчета о расходах. Далее, справа от этих кнопок располагаются кнопки выбора интервала времени, за который формируется отчет о расходах (день, неделя, месяц, период). По нажатию на кнопку `Period` появляется модальный диалог с двумя календарями для выбора начала и окончания периода формирования отчета о расходах. По нажатию на кнопки `Day`, `Week`, `Month` устанавливаются даты начала и окончания периода отчета о расхода. Справа от кнопки `Period` находится кнопка переключающая режим отображения отчета в иде таблицы или в виде столбцовой диаграммы. Ниже кнопок выбора периода на всю ширину страницы (но с отступами от краев) располагается таблица с данными отчета о расходах.

    Наименование колонок таблицы:

    - `Category`;
    - `Expenses`.

    В колонке `Category` отображается наименование категории расходов. Если категория имеет подкатегории, то в колонке `Expenses` отображается суммарные расходы по всем категориям, являющихся подкатегориями для данной категории, а следующими строками идут эти подкатегории со своими расходами.

    Если выбран режим отображения отчета в виде столбцовой диаграммы, то она отображается вместо таблицы.

    В верхней части `Reports page` отображается иконка с изображением фотографии пользователя или placeholder-картинка, если пользователем не задана фотография. По нажатию на эту иконку появляется dropdown-меню с пунктом `Sign out`. Нажатие на пункт меню `Sign out` осуществляет сброс состояния текущего пользователя и JWT, и идет перенаправление на страницу `Sign in page`. Слева от иконки располагается надпись, отображающая email зарегистрированного в приложении пользователя.

6)  ### `Config page` - страница для настройки категорий и подкатегорий.

    На странице отображается вертикальный список категорий (изначально он пуст, при первоначальном запуске backend'а и пустой базе данных, и далее он отображает состояние базы данных). Ниже списка категорий находится кнопка `Add category`, нажатие на которую создает пустую категорию без названия и помещает ее в конец списка категорий. В списке справа от названия категории располагаются кнопки со стрелками вверх и вниз, а также кнопка с изображением `x`. Нажатие на кнопки со стрелками вверх и вниз перемещает категорию по списку соответственно. Нажатие на кнопку с изображением `x` вызывает появление подтверждения удаления категории и затем после успешного подтверждения категория удаляется. Нажатие на название категории открывает модальный диалог для редактирования названия категории. Если у категории есть подкатегории, то они должны отображатся ниже этой категории и их перемещение соответствующими кнопками со стрелками вверх и вних должно быть ограничено пределами той категории, к которой они относятся и следующей категории в списке. При перемещении категории, ее подкатегории перемещаяются вместе с ней. Справа от кнопки с изображением `x` располагается кнопка с изображением `*`. Нажатие на эту кнопку открывает модальный диалог для редактирования списка подкатегорий. Список подкатегорий формируется из списка всех категорий с применением следующего правила - каждая из категорий может быть подкатегорией только одной категории. В этом модальном диалоге должны отображатся подкатегории в виде вертикального списка. Справа от каждой подкатегории находится кнопки со стрелками вверх и вниз, а также кнопка с изображением `x`. Нажатие на эти кнопки аналогично кнопкам в основном списке категорий, за исключением того, что подкатегория не удаляется, и перестает быть подкатегорией и становится обычной категорией (но тем, не менее может иметь свои подкатегории). Ниже списка подкатегорий в модальном диалоге находится кнопка `Add category`, нажатие на которую предлагает пользователю выбрать подкатегорию из списка доступных и затем добавляет эту подкатегорию в список подкатегорий редактируемой категории в модальном диалоге. В правом верхнем углу модального диалога располагается кнопка его закрытия. Любые действия пользователя по изменению списка подкатегорий сразу же записываются в базу данных на backend'е. Аналогично происходит и при редактировании основного списка категорий.

    В верхней части `Config page` отображается иконка с изображением фотографии пользователя или placeholder-картинка, если пользователем не задана фотография. По нажатию на эту иконку появляется dropdown-меню с пунктом `Sign out`. Нажатие на пункт меню `Sign out` осуществляет сброс состояния текущего пользователя и JWT, и идет перенаправление на страницу `Sign in page`. Слева от иконки располагается надпись, отображающая email зарегистрированного в приложении пользователя.
